#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
XMR 15分钟K线 MACD分析指南

由于XMR在主流交易所（币安、OKX等）被下架，无法直接获取15分钟K线API数据。
请在你的交易所手动查看15分钟K线，并对照以下指标判断：

=== 15分钟MACD (12,26,9) 判断标准 ===

1. MACD柱状图（Histogram）分析：
   
   🟢 看涨信号（好转）：
   - 柱状图从负转正（从红变绿）
   - 柱状图连续3根或以上上升
   - 柱状图在零轴上方且扩大
   
   🔴 看跌信号：
   - 柱状图从正转负（从绿变红）
   - 柱状图连续3根或以上下降
   - 柱状图在零轴下方且扩大
   
   🟡 震荡：
   - 柱状图围绕零轴上下波动
   - 没有明确方向

2. 金叉/死叉判断：
   
   🚀 金叉（看涨）：
   - MACD快线（白线）上穿慢线（黄线）
   - 最好发生在零轴下方，反转力度更大
   
   📉 死叉（看跌）：
   - MACD快线下穿慢线
   - 如果在零轴上方死叉，警惕回调

3. 背离判断（重要！）：
   
   🟢 底背离（看涨）：
   - 价格创新低，但MACD柱状图没创新低
   - 说明下跌动能减弱，可能反转
   
   🔴 顶背离（看跌）：
   - 价格创新高，但MACD柱状图没创新高
   - 说明上涨动能减弱，可能回调

=== MA均线系统（15分钟）===

MA5（5根15分钟K线 = 75分钟）
MA15（15根15分钟K线 = 3.75小时）
MA30（30根15分钟K线 = 7.5小时）

🟢 多头排列（看涨）：
   价格 > MA5 > MA15 > MA30

🔴 空头排列（看跌）：
   价格 < MA5 < MA15 < MA30

📈 关键：
   - 价格站上MA15且MA15向上 = 短期转强
   - 价格跌破MA15且MA15向下 = 短期转弱

=== 成交量配合 ===

🟢 上涨放量 = 买盘强劲（可信）
🔴 下跌放量 = 卖盘恐慌（危险）
⚠️ 上涨缩量 = 可能假突破
✅ 下跌缩量 = 下跌动能衰竭（可能见底）

=== 你的仓位判断（开仓$480.43）===

当前价格约：$463-465

1. 如果15分钟MACD柱状图：
   
   ✅ 连续3根上升 + 价格站上MA15
      → 有小反弹机会，可等$470-475减仓
   
   ⚠️ 柱状图震荡 + 价格在MA15附近
      → 方向不明，$465反弹减仓30-50%
   
   🚨 柱状图持续下降 + 价格跌破MA15
      → 继续下跌概率大，立即减仓或止损

2. 关键价位操作：
   
   $475：如果MACD好转反弹到这里 → 减仓30%
   $470：如果有反弹 → 减仓50%
   $465：当前位置，震荡减仓30%
   $463：警戒线，准备止损
   $460：必须止损，不要幻想

3. 你看到的MACD"好转"可能是：
   
   📈 短期技术性反弹（15分钟级别）
      - 从$461反弹到$465，MACD柱状图变小或转正
      - 这是正常的，但不代表趋势反转
      - 大趋势（日线、4小时）仍然下跌
   
   ⚠️ 注意：
      - 15分钟是超短线，容易被骗
      - 要配合1小时、4小时级别确认
      - 目前7天跌-22%，中期趋势很差

=== 实际操作建议 ===

步骤1：打开交易所15分钟K线图
步骤2：查看MACD柱状图最近10根的变化
步骤3：判断：
   
   如果：柱状图连续上升3根以上 且 价格突破MA15
      → 可以观望，等$470-475减仓
   
   否则：
      → 任何反弹到$465-470都应该减仓50%
      → 严格止损$460

当前你的损失：-68.9%（-$2,467）
距离止损线：仅$3.89

结论：即使MACD有小好转，也只是短期反弹，不改变下跌趋势。
      建议趁反弹减仓，保护剩余资金。
"""

print(__doc__)

# 获取当前价格
import requests
try:
    r = requests.get("https://api.coingecko.com/api/v3/simple/price?ids=monero&vs_currencies=usd")
    if r.status_code == 200:
        price = r.json()['monero']['usd']
        entry = 480.43
        
        print(f"\n=== 实时数据 ===")
        print(f"当前价格: ${price:.2f}")
        print(f"开仓价格: ${entry:.2f}")
        print(f"价差: ${price - entry:+.2f} ({((price-entry)/entry*100):+.2f}%)")
        print(f"20x ROI: {((price-entry)/entry*100*20):+.1f}%")
        
        if price >= 475:
            print(f"\n建议: 减仓30%")
        elif price >= 470:
            print(f"\n建议: 观望或小幅减仓")
        elif price >= 463:
            print(f"\n建议: 警戒，任何反弹减仓50%")
        else:
            print(f"\n建议: 🚨 立即减仓或止损！")
            
except:
    pass
