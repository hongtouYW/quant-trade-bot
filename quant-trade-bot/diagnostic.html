<!DOCTYPE html>
<html>
<head>
    <title>å›¾è¡¨è¯Šæ–­å·¥å…·</title>
    <style>
        body { background: #1a1a1a; color: white; font-family: monospace; padding: 20px; }
        .test { background: #333; margin: 10px 0; padding: 10px; border-radius: 4px; }
        .pass { border-left: 4px solid #10b981; }
        .fail { border-left: 4px solid #ef4444; }
        canvas { border: 1px solid #666; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>ğŸ”§ Chart.js è¯Šæ–­å·¥å…·</h1>
    
    <div id="tests"></div>
    
    <h2>ğŸ¯ å®é™…æµ‹è¯•</h2>
    <canvas id="testCanvas" width="400" height="200"></canvas>
    
    <script>
        const tests = document.getElementById('tests');
        
        function addTest(name, passed, details = '') {
            const div = document.createElement('div');
            div.className = `test ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <strong>${passed ? 'âœ…' : 'âŒ'} ${name}</strong><br>
                ${details}
            `;
            tests.appendChild(div);
            return passed;
        }
        
        console.log('å¼€å§‹è¯Šæ–­...');
        
        // æµ‹è¯•1: åŸºæœ¬æµè§ˆå™¨åŠŸèƒ½
        addTest('æµè§ˆå™¨åŸºæœ¬åŠŸèƒ½', true, 'JavaScript æ‰§è¡Œæ­£å¸¸');
        
        // æµ‹è¯•2: Canvasæ”¯æŒ
        const canvas = document.getElementById('testCanvas');
        const hasCanvas = !!canvas.getContext;
        addTest('Canvas æ”¯æŒ', hasCanvas, hasCanvas ? 'Canvas API å¯ç”¨' : 'Canvas ä¸æ”¯æŒ');
        
        // æµ‹è¯•3: 2D Context
        let ctx = null;
        if (hasCanvas) {
            ctx = canvas.getContext('2d');
            addTest('2D Context', !!ctx, ctx ? 'CanvasRenderingContext2D è·å–æˆåŠŸ' : 'æ— æ³•è·å–2Dä¸Šä¸‹æ–‡');
        }
        
        // æµ‹è¯•4: åŸºæœ¬ç»˜å›¾
        if (ctx) {
            try {
                ctx.fillStyle = '#60a5fa';
                ctx.fillRect(10, 10, 100, 50);
                ctx.fillStyle = '#10b981';
                ctx.fillRect(120, 10, 100, 50);
                addTest('åŸºæœ¬ç»˜å›¾', true, 'çŸ©å½¢ç»˜åˆ¶æˆåŠŸ');
            } catch (e) {
                addTest('åŸºæœ¬ç»˜å›¾', false, 'ç»˜å›¾å¤±è´¥: ' + e.message);
            }
        }
        
        // æµ‹è¯•5: Chart.jsåŠ è½½
        function testChartJs() {
            const hasChart = typeof Chart !== 'undefined';
            if (hasChart) {
                addTest('Chart.js åº“', true, `ç‰ˆæœ¬: ${Chart.version || 'æœªçŸ¥'}`);
                
                // æµ‹è¯•6: Chart.jså®ä¾‹åŒ–
                try {
                    const testChart = new Chart(canvas, {
                        type: 'line',
                        data: {
                            labels: ['A', 'B', 'C'],
                            datasets: [{
                                label: 'æµ‹è¯•',
                                data: [1, 2, 3],
                                borderColor: '#60a5fa'
                            }]
                        },
                        options: {
                            responsive: false
                        }
                    });
                    addTest('Chart.js å®ä¾‹åŒ–', true, 'å›¾è¡¨åˆ›å»ºæˆåŠŸ');
                    
                    setTimeout(() => {
                        testChart.destroy();
                        addTest('Chart.js é”€æ¯', true, 'å›¾è¡¨é”€æ¯æˆåŠŸ');
                    }, 1000);
                    
                } catch (e) {
                    addTest('Chart.js å®ä¾‹åŒ–', false, 'å¤±è´¥: ' + e.message);
                }
            } else {
                addTest('Chart.js åº“', false, 'Chart.js æœªåŠ è½½ï¼Œæ­£åœ¨å°è¯•åŠ è½½...');
                
                // å°è¯•åŠ¨æ€åŠ è½½
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.min.js';
                script.onload = () => {
                    addTest('Chart.js åŠ¨æ€åŠ è½½', true, 'åŠ¨æ€åŠ è½½æˆåŠŸ');
                    testChartJs(); // é€’å½’æµ‹è¯•
                };
                script.onerror = () => {
                    addTest('Chart.js åŠ¨æ€åŠ è½½', false, 'CDN æ— æ³•è®¿é—®');
                };
                document.head.appendChild(script);
            }
        }
        
        // å»¶è¿Ÿæµ‹è¯•Chart.jsï¼Œç»™é¡µé¢æ—¶é—´åŠ è½½
        setTimeout(testChartJs, 100);
    </script>
    
    <!-- å°è¯•åŠ è½½Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>